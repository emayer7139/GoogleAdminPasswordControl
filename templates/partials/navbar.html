<!-- templates/partials/navbar.html -->
<nav class="navbar navbar-expand-lg navbar-light bg-light px-4">
    <a class="navbar-brand" href="{{ url_for('main.index') }}">
        <img src="{{ url_for('static', filename='img/logo.png') }}" alt="ResetApp">
    </a>

    <button class="navbar-toggler collapsed border-0" type="button" 
            data-bs-toggle="collapse" data-bs-target="#navbarsExample"
            aria-controls="navbarsExample" aria-expanded="false"
            aria-label="Toggle navigation">
        <i class="bi bi-list" id="mobileIcon"></i>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExample">
        <ul class="navbar-nav ms-auto align-items-center">
            {% if user %}
            <li class="nav-item dropdown d-flex align-items-center">
                <a class="nav-link dropdown-toggle d-flex align-items-center p-0 w-100"
                   href="#" id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="welcome-text">Welcome, {{ user.name }}!</span>
                    <i class="bi bi-list" id="menuIcon"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                    {% if request.endpoint != 'main.index' %}
                    <li>
                        <a class="dropdown-item" href="{{ url_for('main.index') }}">Home</a>
                    </li>
                    {% endif %}
                    <li><a class="dropdown-item" href="{{ url_for('updates_page') }}">What's New</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('instructions_page') }}">Help</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('support_page') }}">Support</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('report_bug_page') }}">Report a Bug</a></li>
                    {% if role in ['admin', 'global_admin'] %}
                    <li><a class="dropdown-item" href="{{ url_for('admin.admin_page') }}">Admin Page</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('status_page') }}">System Status</a></li>
                    {% endif %}
                    <li>
                        <a class="dropdown-item" href="https://support.hart.k12.ga.us" target="_blank">
                            Submit a Ticket
                        </a>
                    </li>
                    <li>
                        <button id="toggleTheme" class="dropdown-item d-flex align-items-center">
                            <i class="bi bi-circle-half me-2"></i>
                            <span id="toggleText">Toggle Dark Mode</span>
                        </button>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">Logout</a></li>
                </ul>
            </li>
            {% else %}
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('auth.login_page') }}">Sign In</a>
            </li>
            {% endif %}
        </ul>
    </div>
</nav>
